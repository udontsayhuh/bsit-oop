using System;
using System.Collections.Generic;

abstract class SimpleCalculator
{
    protected List<string> numbers = new List<string>();
    protected List<char> operators = new List<char>();

    protected void GetInput()
    {
        while (true)
        {
            try
            {
                Console.Write("PLEASE! Enter a number: ");
                string num = NumberInput();

                Console.Write("Enter an operator (+, -, *, /) or '=' to calculate: ");
                char op = OperatorInput();

                numbers.Add(num);
                operators.Add(op);

                if (op == '=')
                    break;
            }
            catch (FormatException)
            {
                Console.WriteLine("NYAK!! Invalid input! Please enter a numerical value or '=' to calculate.");
            }
        }
    }

    protected double Calculate()
    {
        double result = Convert.ToDouble(numbers[0]);
        for (int i = 0; i < operators.Count; i++)
        {
            switch (operators[i])
            {
                case '+':
                    result += Convert.ToDouble(numbers[i + 1]);
                    break;
                case '-':
                    result -= Convert.ToDouble(numbers[i + 1]);
                    break;
                case '*':
                    result *= Convert.ToDouble(numbers[i + 1]);
                    break;
                case '/':
                    if (Convert.ToDouble(numbers[i + 1]) == 0)
                    {
                        Console.WriteLine("Cannot divide by zero!");
                        return double.NaN;
                    }
                    result /= Convert.ToDouble(numbers[i + 1]);
                    break;
            }
        }
        return result;
    }

    protected string NumberInput()
    {
        while (true)
        {
            string input = Console.ReadLine();
            if (double.TryParse(input, out double result))
                return result.ToString();
            else
                Console.WriteLine("NYAK!! Invalid input! Please enter a numerical value.");
        }
    }

    protected char OperatorInput()
    {
        while (true)
        {
            string input = Console.ReadLine();
            if (input.Length == 1 && "+-*/=".Contains(input))
                return input[0];
            else
                Console.WriteLine("NYAK!! Invalid input! Please enter a valid operator (+, -, *, /) or '=' to calculate.");
        }
    }

    public abstract void PerformCalculation();
}

class BasicCalculator : SimpleCalculator
{
    public override void PerformCalculation()
    {
        while (true)
        {
            GetInput();
            if (operators.Count > 0 && operators[operators.Count - 1] == '=' && numbers.Count >= 2)
            {
                double result = Calculate();
                Console.WriteLine("Result: " + result);

                Console.Write("Do you want to perform another calculation? (G lang/ayoko na): ");
                string choice = Console.ReadLine().ToLower();

                if (choice == "ayoko na")
                    break;

                numbers.Clear();
                operators.Clear();
            }
            else
            {
                Console.WriteLine("Invalid input! Please provide at least two numbers and an operator followed by '=' to calculate.");
                numbers.Clear();
                operators.Clear();
            }
        }
        Console.WriteLine("Thank you for using Calculanot 2.0! Goodbye!");
    }
}

class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine("Welcome to Calculanot 2.0");

        BasicCalculator calculator = new BasicCalculator();
        calculator.PerformCalculation();
    }
}


